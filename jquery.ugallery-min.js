(function(c){var b=function(){if(!("id" in arguments.callee)){arguments.callee.id=0}return"ugallery_"+arguments.callee.id++};var a=function(d){if(!("cache" in arguments.callee)){arguments.callee.cache={}}if(!(d in arguments.callee.cache)){arguments.callee.cache[d]=new Image();arguments.callee.cache[d].src=d}};c.fn.ugallery=function(f){var e={forward_btn:"right.gif",backward_btn:"left.gif",controls_vpos:150,animate_controls:true,control_fade_duration:300,controls_fade_from:0.2,controls_fade_to:0.7,fade_duration:1000,show_thumb:false,thumb_position:"right",thumb_bg:"filmv.gif",thumb_img_width:90,thumb_img_height:60,thumb_pnl_width:130,thumb_pnl_opacity:0.6,thumb_img_opacity:0.2,thumb_img_fade_from:0.4,thumb_img_fade_to:1};var d=c.extend(e,f);return this.each(function(){var v=c(this);var C=v.find("a");var z="#"+v.attr("id");var w=b();var m=b();var r=b();var h=b();var n=v.find("div.collection img");var q=b();var l,k;var o;var p=function(){c(z+" .view_pointer_0").removeClass("view_pointer_0");c(z+" .view_pointer_next").removeClass("view_pointer_next");c(z+" .view_pointer_prev").removeClass("view_pointer_prev")};var i=function(){for(var F=0;F<C.length;F++){if(c(C[F]).hasClass("view_pointer_0")){return F}}return -1};var s=function(){var F=i();return c(C[(F==0?C.length-1:F-1)])};var u=function(){var F=i();return c(C[(F==(C.length-1)?0:F+1)])};var j=function(F){p();c(C[F]).addClass("view_pointer_0");c(C[F==0?C.length-1:F-1]).addClass("view_pointer_prev");c(C[F==(C.length-1)?0:F+1]).addClass("view_pointer_next")};var D=function(){a(c(z+" .view_pointer_next").attr("href"));a(c(z+" .view_pointer_prev").attr("href"))};var g=function(I){var H=this;if("mutex" in H&&H.mutex){return}H.mutex=true;var G=c("#"+w).css("opacity")==0?("#"+w):("#"+m);var F=G=="#"+w?("#"+m):("#"+w);c(G).attr("src",c(I).attr("href"));c(F).animate({opacity:0},d.fade_duration/2,function(){c(G).animate({opacity:1},d.fade_duration/2,function(){H.mutex=false})})};var t=function(F){g(F?z+" .view_pointer_next":z+" .view_pointer_prev");var G=C.length;var H=F?1:G-1;j((i()+H)%C.length);D()};var B=function(){c(z).css("height",v.css("height"));v.prepend('<div class="viewport"></div>');c(z+" div.viewport").css({width:v.css("width"),height:v.css("height"),position:"absolute",left:0,top:0});c(z+" div.viewport").prepend('<img id="'+w+'" class="aniview" />\n<img id="'+m+'" class="aniview" />\n<img id="'+h+'" src="'+d.forward_btn+'" />\n<img id="'+r+'" src="'+d.backward_btn+'" />\n');c("#"+w+",#"+m).css({position:"absolute",top:0,left:0});c("#"+m).css("opacity",0);c("#"+h).css({position:"absolute",right:0,top:d.controls_vpos,"z-index":2,opacity:d.controls_fade_from,cursor:"pointer"});c("#"+r).css({position:"absolute",left:0,top:d.controls_vpos,"z-index":2,opacity:d.controls_fade_from,cursor:"pointer"});if(d.animate_controls){c("#"+h+",#"+r).hover(function(G){c(this).animate({opacity:d.controls_fade_to},d.controls_fade_duration,function(){})},function(G){c(this).animate({opacity:d.controls_fade_from},d.controls_fade_duration,function(){})})}j(0);D();c("#"+w).attr("src",c(z+" .view_pointer_0").attr("href"));if(d.show_thumb){l=(d.thumb_pnl_width-d.thumb_img_width)/2;k=12;c(z).prepend('<div class="thumbs"></div>');c(z+" div.thumbs").css("overflow","hidden");switch(d.thumb_position){case"right":c(z+" .thumbs").css({position:"absolute",left:v.css("width")+1,width:d.thumb_pnl_width,height:v.css("height")});break;case"left":c(z+" .thumbs").css({position:"absolute",left:0,width:d.thumb_pnl_width,height:v.css("height")});c(z+" div.viewport").css({left:d.thumb_pnl_width+1});break}c(z+" .thumbs").append('<div id="'+q+'" class="thumb_panel"></div>\n');o=n.length*(d.thumb_img_height+k)+k;c("#"+q).css({"background-image":"url("+d.thumb_bg+")",height:o,opacity:d.thumb_pnl_opacity,border:d.thumb_border_style});var F=k;n.each(function(){c(this).attr("title",c(this).parent().attr("href"));c(this).css({left:l,top:F,opacity:d.thumb_img_opacity});c(this).hover(function(){c(this).css("opacity",d.thumb_img_fade_to)},function(){c(this).css("opacity",d.thumb_img_fade_from)});c("#"+q).append(this);F+=(k+d.thumb_img_height)})}}();var y=-1,x=-1;var E=function(I){if(y!=-1&&x!=-1){var G=c(z+" .thumbs").width();var F=c(z+" .thumbs").height();var H=(x*2*7)/F-7;if(H>3||H<-3){c("#"+q).css("top",function(L,K){return parseFloat(K)-H})}var J=parseFloat(c("#"+q).css("top"));if(J>0){c("#"+q).css("top",0)}if(J<-o+F){c("#"+q).css("top",-o+F)}}};c("#"+h).click(function(){t(true)});c("#"+r).click(function(){t(false)});var A;c(z+" .thumbs").mousemove(function(F){y=F.pageX-c(z+" .thumbs").offset().left;x=F.pageY-c(z+" .thumbs").offset().top});c(z+" .thumbs").hover(function(F){A=setInterval(function(){E(F)},20)},function(){clearInterval(A);y=-1;x=-1});c("#"+q+" img").click(function(){p();c(z+" div.collection a[href="+c(this).attr("title")+"]").addClass("view_pointer_0");j(i());g(z+" .view_pointer_0");D()})})}})(jQuery);